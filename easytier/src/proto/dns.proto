syntax = "proto3";

import "common.proto";

package dns;

message ZoneData {
  common.UUID id = 1;
  string origin = 2;
  repeated string records = 3;
  repeated common.Url forwarders = 4;
}

message GetExportConfigRequest {}

message GetExportConfigResponse {
  repeated ZoneData zones = 1;
  string fqdn = 2;
}

service DnsPeerMgrRpc {
    rpc GetExportConfig(GetExportConfigRequest) returns (GetExportConfigResponse) {}
}

message DnsSnapshot {
  repeated ZoneData zones = 1;
  repeated common.Url addresses = 2;
  repeated common.Url listeners = 3;
}

message HeartbeatRequest {
  common.UUID id = 1;
  bytes digest = 2;
  optional DnsSnapshot snapshot = 3;
}

message HeartbeatResponse {
  bool resync = 1;
}

service DnsServerRpc {
    rpc Heartbeat(HeartbeatRequest) returns (HeartbeatResponse) {}
}
