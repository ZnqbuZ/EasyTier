syntax = "proto3";

import "common.proto";

package dns;

message DnsConfigPb {
  repeated ZoneConfigPb zones = 1;
  string fqdn = 2;
}

message ZoneConfigPb {
  common.UUID id = 1;
  string origin = 2;
  uint32 ttl = 3;
  repeated string records = 4;
  repeated string forwarders = 5;
}

message DnsSnapshot {
    repeated ZoneConfigPb zones = 1;
    repeated common.SocketAddr addresses = 2;
    repeated common.Url listeners = 3;
}

message DnsHeartbeat {
    common.UUID inst_id = 1;
    uint64 checksum = 2;
    optional DnsSnapshot data = 3;
}

service DnsServerRpc {
    rpc Heartbeat(DnsHeartbeat) returns (common.Void) {}
    rpc GetConfig(common.Void) returns (DnsConfigPb) {}
}
